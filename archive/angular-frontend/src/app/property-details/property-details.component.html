<div class="wrapper">
   <app-header></app-header>

   <div class="property-section py-60 mt-66">
      <div class="container">
         <!-- Breadcrumb -->
         <div class="row pagination mb-4">
            <div class="col-12">
               <nav aria-label="breadcrumb">
                  <ol class="breadcrumb list-unstyled d-flex align-items-center mb-0">
                     <li class="breadcrumb-item"><a routerLink="/" class="text-dark">Home</a></li>
                     <li class="breadcrumb-item"><a routerLink="/agents/{{state}}/{{city}}"
                           class="text-dark">{{stateName}}</a></li>
                     <li class="breadcrumb-item"><a routerLink="/agents/{{state}}/{{city}}"
                           class="text-dark">{{cityName}}</a></li>
                     <li class="breadcrumb-item active" aria-current="page">{{agentData?.company_name}}</li>
                  </ol>
               </nav>
            </div>
         </div>

         <div class="row">
            <!-- Main Content Column -->
            <div class="col-lg-8">
               <!-- PM Header Card -->
               <div class="card border-0 shadow-sm mb-4">
                  <div class="card-body p-4">
                     <div class="d-flex align-items-start gap-4">
                        <div class="logo-img flex-shrink-0">
                           <img style="border: 1px solid #ccc; border-radius: 8px;" src="{{agentData?.photo}}"
                              alt="{{agentData?.company_name}}" width="120" height="120" class="img-fluid">
                        </div>
                        <div class="flex-grow-1">
                           <div class="d-flex justify-content-between align-items-start">
                              <div>
                                 <h1 class="h3 mb-2">{{agentData?.company_name}}</h1>
                                 <p class="text-muted mb-2">
                                    <i class="bi bi-geo-alt"></i> {{agentData?.address}}
                                 </p>
                              </div>
                              <!-- BBB Rating Badge -->
                              <div *ngIf="agentData?.bbb_rating" class="text-center">
                                 <div class="badge bg-success text-white px-3 py-2" style="font-size: 1.2rem;">
                                    {{agentData?.bbb_rating}}
                                 </div>
                                 <div class="small text-muted mt-1">BBB Rating</div>
                              </div>
                           </div>

                           <!-- Quick Stats -->
                           <div class="d-flex flex-wrap gap-3 mt-3">
                              <span *ngIf="agentData?.years_in_business" class="badge bg-light text-dark border">
                                 <i class="bi bi-calendar-check"></i> {{agentData?.years_in_business}}
                              </span>
                              <span *ngIf="agentData?.rentals_managed" class="badge bg-light text-dark border">
                                 <i class="bi bi-house"></i> {{agentData?.rentals_managed}} managed
                              </span>
                              <span *ngIf="agentData?.featured" class="badge bg-primary text-white">
                                 <i class="bi bi-star-fill"></i> Featured
                              </span>
                           </div>

                           <!-- Service Types Pills -->
                           <div *ngIf="agentData?.service_types" class="mt-3">
                              <span *ngFor="let type of agentData?.service_types?.split(',')"
                                 class="badge bg-info bg-opacity-10 text-info me-2 mb-1">
                                 {{type.trim()}}
                              </span>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>

               <!-- About Section -->
               <div class="card border-0 shadow-sm mb-4">
                  <div class="card-body p-4">
                     <h2 class="h5 mb-3">About {{agentData?.company_name}}</h2>
                     <p class="mb-0">{{agentData?.about}}</p>
                  </div>
               </div>

               <!-- Fee Breakdown -->
               <div class="card border-0 shadow-sm mb-4">
                  <div class="card-body p-4">
                     <h2 class="h5 mb-3">
                        <i class="bi bi-cash-stack text-primary"></i> Fee Breakdown
                     </h2>
                     <div class="table-responsive">
                        <table class="table table-striped mb-0">
                           <tbody>
                              <tr *ngIf="agentData?.management_fee">
                                 <td class="fw-medium">Management Fee</td>
                                 <td class="text-end">{{agentData?.management_fee}}</td>
                              </tr>
                              <tr *ngIf="agentData?.tenant_placement_fee">
                                 <td class="fw-medium">Tenant Placement Fee</td>
                                 <td class="text-end">{{agentData?.tenant_placement_fee}}</td>
                              </tr>
                              <tr *ngIf="agentData?.lease_renewal_fee">
                                 <td class="fw-medium">Lease Renewal Fee</td>
                                 <td class="text-end">{{agentData?.lease_renewal_fee}}</td>
                              </tr>
                              <tr *ngIf="agentData?.miscellaneous_fees">
                                 <td class="fw-medium">Other Fees</td>
                                 <td class="text-end">{{agentData?.miscellaneous_fees}}</td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <p *ngIf="!agentData?.management_fee && !agentData?.tenant_placement_fee" class="text-muted mb-0">
                        Contact this property manager for pricing details.
                     </p>
                  </div>
               </div>

               <!-- Contact Info -->
               <div class="card border-0 shadow-sm mb-4">
                  <div class="card-body p-4">
                     <h2 class="h5 mb-3">Contact Information</h2>
                     <div class="row g-3">
                        <div class="col-md-6" *ngIf="agentData?.phone">
                           <a href="tel:{{agentData?.phone}}" class="btn btn-outline-primary w-100">
                              <i class="bi bi-telephone"></i> {{agentData?.phone}}
                           </a>
                        </div>
                        <div class="col-md-6" *ngIf="agentData?.website">
                           <a href="{{agentData?.website}}" target="_blank" class="btn btn-outline-secondary w-100">
                              <i class="bi bi-globe"></i> Visit Website
                           </a>
                        </div>
                     </div>
                  </div>
               </div>
            </div>

            <!-- Sidebar Column -->
            <div class="col-lg-4">
               <!-- Lead Capture Form -->
               <div class="card border-0 shadow-sm sticky-top" style="top: 100px;">
                  <div class="card-body p-4">
                     <h3 class="h5 mb-3 text-center">
                        <i class="bi bi-envelope-paper text-primary"></i> Request a Quote
                     </h3>
                     <p class="text-muted text-center small mb-4">
                        Get connected with {{agentData?.company_name}} and similar top-rated managers in {{cityName}}.
                     </p>
                     <form>
                        <div class="mb-3">
                           <input type="text" id="name" class="form-control" placeholder="Your Name" required>
                        </div>
                        <div class="mb-3">
                           <input type="email" id="email" class="form-control" placeholder="Email Address" required>
                        </div>
                        <div class="mb-3">
                           <input type="tel" id="mobile" class="form-control" placeholder="Phone Number" required>
                        </div>
                        <div class="mb-3">
                           <textarea id="message" class="form-control" rows="3"
                              placeholder="Tell us about your property..."></textarea>
                        </div>
                        <button type="button" id="submitBtn2" class="btn btn-primary w-100 py-2" (click)="submit()">
                           Get Matched <i class="bi bi-arrow-right"></i>
                        </button>
                     </form>
                     <p class="text-muted text-center small mt-3 mb-0">
                        <i class="bi bi-shield-check"></i> Your info is secure and never shared.
                     </p>
                  </div>
               </div>
            </div>
         </div>

         <!-- Related Property Managers -->
         <div class="row mt-5" *ngIf="relatedManagers && relatedManagers.length > 0">
            <div class="col-12">
               <h2 class="h5 mb-4">Other Property Managers in {{cityName}}</h2>
               <div class="row g-4">
                  <div class="col-md-4" *ngFor="let related of relatedManagers">
                     <div class="card border-0 shadow-sm h-100">
                        <div class="card-body p-3">
                           <div class="d-flex align-items-center gap-3 mb-3">
                              <img src="{{related.photo}}" alt="{{related.company_name}}" width="60" height="60"
                                 class="rounded" style="object-fit: cover; border: 1px solid #eee;">
                              <div>
                                 <h6 class="mb-1">{{related.company_name}}</h6>
                                 <span *ngIf="related.bbb_rating" class="badge bg-success small">
                                    {{related.bbb_rating}}
                                 </span>
                              </div>
                           </div>
                           <a routerLink="/agent/{{state}}/{{city}}/{{related.slug}}"
                              class="btn btn-outline-primary btn-sm w-100">
                              View Details
                           </a>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>

   <!-- Footer -->
   <app-footer></app-footer>
</div>